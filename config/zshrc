# Basic zsh configuration for Kali Linux
export LANG=en_US.UTF-8
export PATH=$HOME/bin:$HOME/.local/bin:/usr/local/bin:$PATH
export EDITOR="nvim"
export TERMINAL=kitty

# History configuration
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt appendhistory
setopt sharehistory
setopt incappendhistory

# Basic options
setopt autocd
setopt nomatch
setopt menucomplete
setopt interactive_comments
stty stop undef		# Disable ctrl-s to freeze terminal

# Completions
autoload -Uz compinit
compinit
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
zstyle ':completion:*' menu select

# Custom aliases
## Quick edit
alias zshrc="nvim ~/.zshrc"
alias i3config="nvim ~/.config/i3/config"

## Drop-in replacements (if available)
if command -v bat > /dev/null 2>&1; then
    alias cat="bat"
    alias pcat="bat -p"
fi

if command -v lsd > /dev/null 2>&1; then
    alias ls="lsd"
    alias l="lsd -lA --date relative"
fi

## Other aliases
alias ll="ls -la"
alias la="ls -la"
alias grep="grep --color=auto"
alias btop="btop"
alias top="btop"

# Functions
function mkcd() {
    mkdir -p "$1" && cd "$1"
}

# Initialize zoxide for smart directory navigation
if command -v zoxide > /dev/null 2>&1; then
    eval "$(zoxide init --cmd cd zsh)"
fi

# Load zsh-syntax-highlighting (if available)
if [ -f "/usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ]; then
    source /usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

# Load custom Catppuccin theme for syntax highlighting
if [ -f "~/.config/zsh/catppuccin_macchiato-zsh-syntax-highlighting.zsh" ]; then
    source ~/.config/zsh/catppuccin_macchiato-zsh-syntax-highlighting.zsh
fi

# Load zsh-autosuggestions (if available)
if [ -f "/usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh" ]; then
    source /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh
fi

# Oh My Posh prompt
if command -v oh-my-posh > /dev/null 2>&1; then
    eval "$(oh-my-posh init zsh --config ~/.config/oh-my-posh/zen.toml)"
fi

# Key bindings
bindkey "^[[3~" delete-char

# Load fastfetch on new terminal (if available and not in VS Code)
if command -v fastfetch > /dev/null 2>&1 && [ -z "$TERM_PROGRAM" ]; then
    fastfetch
fi